"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[951],{723420:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.clearPurchaseError=function(){a.default.dispatch({type:h.ActionTypes.SKU_PURCHASE_CLEAR_ERROR})};t.fetchPurchasePreview=function(e,t,n){return E.apply(this,arguments)};t.fetchSKU=function(e,t){return _.apply(this,arguments)};t.fetchSKUsForApplication=function(e,t){return S.apply(this,arguments)};t.grantChannelBranchEntitlement=function(e,t,n){return T.apply(this,arguments)};t.purchaseSKU=function(e,t,n){return A.apply(this,arguments)};t.showPurchaseConfirmationStep=function(){a.default.wait((function(){return a.default.dispatch({type:h.ActionTypes.SKU_PURCHASE_SHOW_CONFIRMATION_STEP})}))};t.updateSKUPaymentIsGift=function(e){a.default.dispatch({type:h.ActionTypes.SKU_PURCHASE_UPDATE_IS_GIFT,isGift:e})}
;var r=y(n(118915)),a=y(n(636602)),u=n(327269),o=n(400922),l=y(n(225035)),i=y(n(399561)),s=y(n(424099)),d=n(537683),c=n(71246),f=n(204785),p=n(832635),h=n(770348);function y(e){return e&&e.__esModule?e:{default:e}}function v(){v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return v.apply(this,arguments)}function g(e,t,n,r,a,u,o){try{var l=e[u](o),i=l.value}catch(e){n(e);return}l.done?t(i):Promise.resolve(i).then(r,a)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var u=e.apply(t,n);function o(e){g(u,r,a,o,l,"next",e)}function l(e){g(u,r,a,o,l,"throw",e)}o(void 0)}))}}function _(){return(_=m(regeneratorRuntime.mark((function e(t,n){var r,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==i.default.get(n)){e.next=2;break}return e.abrupt("return");case 2:a.default.dirtyDispatch({
type:h.ActionTypes.SKU_FETCH_START,skuId:n});e.prev=3;r=s.default.inTestModeForApplication(t);e.next=7;return(0,f.httpGetWithCountryCodeQuery)(r?h.Endpoints.STORE_SKU(n):h.Endpoints.STORE_PUBLISHED_LISTINGS_SKU(n));case 7:u=e.sent;a.default.dispatch({type:h.ActionTypes.SKU_FETCH_SUCCESS,sku:r?u.body:u.body.sku});e.next=15;break;case 11:e.prev=11;e.t0=e.catch(3);a.default.dispatch({type:h.ActionTypes.SKU_FETCH_FAIL,skuId:n});throw new l.default("Failed to fetch SKU "+n);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}function S(){return(S=m(regeneratorRuntime.mark((function e(t,n){var r,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n=!0);if(s.default.inTestModeForApplication(t)||!n){e.next=3;break}throw new Error("this should only be used in test mode");case 3:e.next=5;return(0,f.httpGetWithCountryCodeQuery)(h.Endpoints.APPLICATION_SKUS(t));case 5:r=e.sent;u=r.body;a.default.dispatch({
type:h.ActionTypes.SKUS_FETCH_SUCCESS,skus:u,applicationId:t});return e.abrupt("return",u);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=m(regeneratorRuntime.mark((function e(t,n,r){var u,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u={payment_source_id:r};s.default.inTestModeForApplication(t)&&(u.test_mode=!0);e.next=4;return(0,f.httpGetWithCountryCodeQuery)({url:h.Endpoints.STORE_SKU_PURCHASE(n),query:u,oldFormErrors:!0});case 4:o=e.sent;a.default.dispatch({type:h.ActionTypes.SKU_PURCHASE_PREVIEW_FETCH_SUCCESS,skuId:n,paymentSourceId:r,price:o.body});return e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=m(regeneratorRuntime.mark((function e(t,n,o){var l,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.default.dispatch({type:h.ActionTypes.SKU_PURCHASE_START,applicationId:t,skuId:o});e.prev=1;e.next=4
;return r.default.post({url:h.Endpoints.CHANNEL_ENTITLEMENT_GRANT(n),oldFormErrors:!0});case 4:l=e.sent;a.default.dispatch({type:h.ActionTypes.SKU_PURCHASE_SUCCESS,skuId:o,entitlements:l.body,libraryApplications:[]});return e.abrupt("return",l.body);case 9:e.prev=9;e.t0=e.catch(1);i=new u.BillingError(e.t0);a.default.dispatch({type:h.ActionTypes.SKU_PURCHASE_FAIL,applicationId:t,skuId:o,error:i});throw i;case 14:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}var b={isGift:!1};function A(){return(A=m(regeneratorRuntime.mark((function e(t,n,l){var i,f,y,g,m,_,S,E,T,A,C,I;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=v({},b,{},l),f=i.paymentSource,y=i.expectedAmount,g=i.expectedCurrency,m=i.analyticsLoadId,_=i.isGift,S=i.giftStyle,E=i.subscriptionPlanId;a.default.wait((function(){a.default.dispatch({type:h.ActionTypes.SKU_PURCHASE_START,applicationId:t,skuId:n})}));e.prev=2;T={gift:_,sku_subscription_plan_id:E}
;if(!s.default.inTestModeForApplication(t)){e.next=8;break}T.test_mode=!0;e.next=22;break;case 8:if(null==f){e.next=18;break}T.payment_source_id=f.id;e.next=12;return(0,p.createPaymentSourceToken)(f);case 12:T.payment_source_token=e.sent;if(!h.ADYEN_PAYMENT_SOURCES.has(f.type)){e.next=18;break}e.next=16;return(0,p.popupBridgeState)(f.type);case 16:A=e.sent;T.return_url=r.default.getAPIBaseURL()+h.Endpoints.BILLING_POPUP_BRIDGE_CALLBACK_REDIRECT_PREFIX(f.type,null!=A?A:"","success");case 18:null!=y&&(T.expected_amount=y);null!=g&&(T.expected_currency=g);null!=S&&(T.gift_style=S);T.purchase_token=(0,d.getPurchaseToken)();case 22:e.next=24;return r.default.post({url:h.Endpoints.STORE_SKU_PURCHASE(n),body:T,context:{load_id:m},oldFormErrors:!0});case 24:C=e.sent;a.default.dispatch({type:h.ActionTypes.SKU_PURCHASE_SUCCESS,skuId:n,libraryApplications:null!=C.body.library_applications?C.body.library_applications.filter(c.isNotNullish):[],entitlements:C.body.entitlements,
giftCode:C.body.gift_code});return e.abrupt("return",v({},C.body,{redirectConfirmation:!1}));case 29:e.prev=29;e.t0=e.catch(2);if((I=e.t0 instanceof u.BillingError?e.t0:new u.BillingError(e.t0)).code===o.ErrorCodes.CONFIRMATION_REQUIRED){e.next=35;break}a.default.dispatch({type:h.ActionTypes.SKU_PURCHASE_FAIL,applicationId:t,skuId:n,error:I});throw I;case 35:if(e.t0.body.payment_id){e.next=37;break}throw(0,p.dispatchConfirmationError)("payment id cannot be null on redirected confirmations.");case 37:return e.abrupt("return",(0,p.handleConfirmation)(e.t0.body,f));case 38:case"end":return e.stop()}}),e,null,[[2,29]])})))).apply(this,arguments)}},441224:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=t.SearchBarIcon=t.RichTagTypes=void 0;var r,a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor
;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var o=a?Object.getOwnPropertyDescriptor(e,u):null;o&&(o.get||o.set)?Object.defineProperty(r,u,o):r[u]=e[u]}r.default=e;n&&n.set(e,r);return r}(n(667294)),u=m(n(294184)),o=m(n(213192)),l=m(n(314234)),i=m(n(151097)),s=m(n(16941)),d=m(n(259530)),c=m(n(348763)),f=m(n(628551)),p=m(n(582945)),h=n(518802),y=n(770348),v=m(n(247001)),g=m(n(544064));function m(e){return e&&e.__esModule?e:{default:e}}function _(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_=function(e){return e?n:t})(e)}function S(){S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return S.apply(this,arguments)}function E(e,t){E=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return E(e,t)}function T(e,t,n,a){r||(r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103)
;var u=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=a;else if(o>1){for(var l=new Array(o),i=0;i<o;i++)l[i]=arguments[i+3];t.children=l}if(t&&u)for(var s in u)void 0===t[s]&&(t[s]=u[s]);else t||(t=u||{});return{$$typeof:r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var b=Object.freeze({SMALL:g.default.small,MEDIUM:g.default.medium,LARGE:g.default.large}),A=(0,o.default)({MEMBER:null,ROLE:null,CHANNEL:null});t.RichTagTypes=A;var C=function(e){var t,n,r,a=e.hasContent,o=e.onClear,l=e.className,i=e.themeOverride,f=e.size,p=void 0===f?b.SMALL:f;return T(s.default,{className:(0,u.default)(l,g.default.iconLayout,p,(0,h.getThemeClass)(i),(t={},t[g.default.clear]=a,t)),onClick:function(e){e.stopPropagation();null!=o&&o(e)},onMouseDown:function(e){e.preventDefault();e.stopPropagation()},tabIndex:a?0:-1,"aria-hidden":!a,"aria-label":v.default.Messages.SEARCH_CLEAR,focusProps:{offset:4}},void 0,T("div",{
className:g.default.iconContainer},void 0,T(c.default,{className:(0,u.default)((n={},n[g.default.icon]=!0,n[g.default.visible]=!a,n))}),T(d.default,{className:(0,u.default)((r={},r[g.default.icon]=!0,r[g.default.visible]=a,r))})))};t.SearchBarIcon=C;C.displayName="SearchBarIcon";var I=function(e){!function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;E(e,t)}(t,e);function t(){for(var t,n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];(t=e.call.apply(e,[this].concat(r))||this).defaultInputProps={role:"combobox","aria-haspopup":"listbox","aria-autocomplete":"list"};t.ref=a.createRef();t.containerRef=a.createRef();t.handleKeyDown=function(e){var n=t.props,r=n.onActivate,a=n.onKeyDown,u=n.onQueryChange,o=n.useKeyboardNavigation;null!=a&&a(e);var l=t.ref.current;if(null!=l&&null==r)if(e.keyCode===y.KeyboardKeys.ESCAPE&&null!=l.value&&""!==l.value&&l.value.length>0){l.value="";null!=u&&u("")
}else o&&(t.props.gridResults?t.handleKeyDownGrid(e):t.handleKeyDownList(e));else e.keyCode!==y.KeyboardKeys.TAB&&null!=r&&r(e)};t.handleChange=function(e){var n=t.props.onQueryChange;null!=n&&n(e.currentTarget.value)};t.handleFocus=function(e){var n=t.props.onFocus;null!=n&&n(e)};t.handleClear=function(){var e=t.props.onClear,n=t.ref.current;null!=e&&e();null!=n&&n.focus()};t.handleRemoveTag=function(e){var n=t.props.onRemoveTag;null==n||n(e)};t.focus=function(){var e=t.ref.current;null!=e&&e.focus()};return t}var n=t.prototype;n.componentDidUpdate=function(e){var t=this.props,n=t.focusAfterReady,r=t.isReady;n&&!e.isReady&&r&&this.focus()};n.handleKeyDownGrid=function(e){var t=this.props,n=t.selectedRow,r=t.selectedColumn,a=t.sections,u=t.query,o=t.tags,l=t.onSelectionChange,i=t.onSelect,s=t.onRemoveTag,d=t.preventEscapePropagation;if(0!==a.length){switch(e.keyCode){case y.KeyboardKeys.BACKSPACE:if((null==u||0===u.length)&&null!=o&&o.length>0){e.preventDefault();e.stopPropagation()
;null==s||s(o.length-1)}break;case y.KeyboardKeys.ARROW_DOWN:e.preventDefault();e.stopPropagation();if(-1===n){n=0;r=0}else{(n+=1)>=a.length&&(n=a.length-1);r>=a[n]&&(r=a[n]-1)}break;case y.KeyboardKeys.ARROW_UP:e.preventDefault();e.stopPropagation();if((n-=1)<0){n=0;r=0}else r>=a[n]&&(r=a[n]-1);break;case y.KeyboardKeys.ARROW_LEFT:e.preventDefault();e.stopPropagation();-1===n&&(n=0);if((r-=1)<0)if((n-=1)>=0)r=a[n]-1;else if(n<0){n=0;r=0}break;case y.KeyboardKeys.ARROW_RIGHT:e.preventDefault();e.stopPropagation();-1===n&&(n=0);if((r+=1)>=a[n]){r=0;(n+=1)>=a.length&&(r=a[n=a.length-1]-1)}break;case y.KeyboardKeys.ENTER:e.preventDefault();e.stopPropagation();-1===n&&(n=0);-1===r&&(r=0);if(n>=a.length||r>=a[n])return;null!=i&&i(n,r,e);return;case y.KeyboardKeys.ESCAPE:e.preventDefault();d&&e.stopPropagation();null!=i&&i(null,null,e);return;default:return}null!=l&&l(n,r)}};n.handleKeyDownList=function(e){
var t=this.props,n=t.sections,r=t.selectedSection,a=t.selectedRow,u=t.onSelect,o=t.onSelectionChange,l=t.query,i=t.tags,s=t.preventEscapePropagation,d=this.ref.current;if(null!=d)switch(e.keyCode){case y.KeyboardKeys.BACKSPACE:if((null==l||0===l.length)&&null!=i&&i.length>0){var c,f;e.preventDefault();e.stopPropagation();null===(c=(f=this.props).onRemoveTag)||void 0===c||c.call(f,i.length-1)}break;case y.KeyboardKeys.ARROW_DOWN:e.preventDefault();e.stopPropagation();if(n.length>r&&++a>=n[r]){++r>=n.length&&(r=0);a=0}null==o||o(r,a);break;case y.KeyboardKeys.ARROW_UP:e.preventDefault();e.stopPropagation();if(--a<0){--r<0&&(r=n.length-1);a=n[r]-1}null==o||o(r,a);break;case y.KeyboardKeys.ENTER:e.preventDefault();e.stopPropagation();n.length>r&&n[r]>a&&(null==u||u(r,a,e));break;case y.KeyboardKeys.ESCAPE:e.preventDefault();s&&e.stopPropagation();null==u||u(null,null,e);d.blur()}};n.render=function(){
var e,t,n=this,r=this.props,o=r.autoFocus,s=r.query,c=r.placeholder,y=void 0===c?v.default.Messages.DM_SEARCH_PLACEHOLDER:c,m=r.themeOverride,_=r.disabled,E=r.onClear,b=r.size,I=r.maxHeight,R=r.tags,P=r.onActivate,O=r.className,w=r.inputProps,M=r.focusAfterReady,N=null!=s&&s.length>0,U=!1,k=[];if(null!=R&&R.length>0)if("string"==typeof R[0]){R.forEach((function(e,t){return k.push(T(i.default,{focusProps:{offset:4},className:g.default.tag,onClick:n.handleRemoveTag.bind(n,t)},t,e,T(d.default,{className:g.default.close,"aria-label":v.default.Messages.REMOVE})))}))}else{U=!0;R.forEach((function(e,t){return k.push(T(i.default,{className:(0,u.default)(g.default.tag,g.default.richTag),onClick:n.handleRemoveTag.bind(n,t)},t,e.type===A.MEMBER&&e.avatar&&T(f.default,{src:e.avatar,"aria-hidden":!0,size:f.default.Sizes.SIZE_16}),e.type===A.ROLE&&e.color&&T("span",{className:g.default.tagRoleColor,style:{backgroundColor:e.color}}),T("span",{className:g.default.tagLabel
},void 0,e.label),T(d.default,{className:g.default.close,"aria-label":v.default.Messages.REMOVE})))}))}return T(l.default,{focusTarget:this.ref,ringTarget:this.containerRef},void 0,a.createElement("div",{ref:this.containerRef,className:(0,u.default)(O,g.default.container,b,(0,h.getThemeClass)(m),(e={},e[g.default.disabled]=_,e))},T(p.default,{className:g.default.inner,style:{maxHeight:I}},void 0,k,a.createElement("input",S({className:(0,u.default)(g.default.input,(t={},t[g.default.richTagInput]=U,t)),type:"text",ref:this.ref,spellCheck:"false",placeholder:y,value:s,onChange:this.handleChange,onKeyDown:this.handleKeyDown,onFocus:this.handleFocus,disabled:_,"aria-disabled":_,autoFocus:!M&&o,onMouseDown:P},this.defaultInputProps,w)),null!=E?T(C,{size:b,themeOverride:m,hasContent:N,onClear:this.handleClear}):null)))};return t}(a.Component);I.displayName="SearchBar";I.Sizes=b;I.defaultProps={size:b.SMALL,query:"",sections:[],selectedSection:0,selectedRow:-1,selectedColumn:-1,gridResults:!1,
disabled:!1,autoFocus:!1,preventEscapePropagation:!0,useKeyboardNavigation:!0};var R=I;t.default=R},973523:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.GuildForumExperiment=void 0;t.getEnableForumPermissions=function(e){return M.getCurrentConfig({guildId:e}).enabled};t.useAppliedTags=function(e){var t=U(e);return null==e||null==t?[]:e.appliedTags.map((function(e){return null==t?void 0:t[e]})).filter((function(e){return null!=e}))};t.useCanCreateForumChannel=function(e){return N(e)};t.useCanManageChannel=function(e){return(0,o.useStateFromStores)([v.default],(function(){return v.default.can(C.Permissions.MANAGE_CHANNELS,e)}))};t.useExistingPin=function(e){var t=(0,o.useStateFromStoresObject)([c.default],(function(){return c.default.getThreadsForGuild(e.guild_id)}),[e.guild_id]);return(0,a.default)(t).values().map((function(e){var t=e.id;return h.default.getChannel(t)})).filter(E.isNotNullish).find((function(t){
return t.parent_id===e.parent_id&&t.hasFlag(I.ChannelFlags.PINNED)}))};t.useFacepileUsers=function(e,t){var n=(0,o.useStateFromStoresArray)([S.default],(function(){return t.map((function(e){return S.default.getUser(e)}))}));r.useEffect((function(){t.filter((function(e,t){return null==n[t]})).forEach((function(t){y.default.requestMember(e.guild_id,t)}))}),[]);return n};t.useFirstAppliedTag=function(e){var t=U(e);return r.useMemo((function(){var n=e.appliedTags.find((function(e){return null!=(null==t?void 0:t[e])}));return null!=n?null==t?void 0:t[n]:void 0}),[t,e.appliedTags])};t.useFormumPostMarkup=function(e){var t=r.useMemo((function(){return null!=(null==e?void 0:e.content)&&""!==e.content?(0,s.default)(e,{formatInline:!0,allowHeading:!0,allowList:!0}):{hasSpoilerEmbeds:!1,content:null}}),[e]),n=t.hasSpoilerEmbeds,a=t.content,u=(0,b.useFindFirstMediaProperties)(e,n);return{hasSpoilerEmbeds:n,content:a,firstMedia:u}};t.useForumPostCreator=function(e){var t=(0,
o.useStateFromStores)([S.default],(function(){return S.default.getUser(e.ownerId)})),n=(0,d.useNullableUserAuthor)(t,e);r.useEffect((function(){null!=e.ownerId&&y.default.requestMember(e.guild_id,e.ownerId)}),[e.guild_id,e.ownerId]);return{user:t,author:n}};t.useIsForumExperimentEnabled=N;t.useLastActiveTimestamp=function(e,t){var n=u.default.extractTimestamp((0,o.useStateFromStores)([g.default],(function(){return g.default.lastMessageId(e.id)}))),r=u.default.extractTimestamp(e.id);return t===R.SortOrder.Creation?(0,p.getForumCreatedAgoTimestampString)(r):(0,p.getForumActiveAgoTimestampString)(n)};t.useLoadForumUnreadCounts=function(e,t){var n=(0,o.useStateFromStores)([c.default],(function(){return c.default.hasLoaded(e.guild_id)}));r.useEffect((function(){if(n){var r=T.default.getThreadIds(e.id,t),a=A.default.getThreadIdsMissingCounts(e.guild_id,r.map((function(e){return e.channelId}))).filter((function(e){return null!=g.default.getTrackedAckMessageId(e)})).map((function(e){return{
threadId:e,ackMessageId:g.default.getTrackedAckMessageId(e)}}));a.length>0&&l.default.dirtyDispatch({type:C.ActionTypes.REQUEST_FORUM_UNREADS,guildId:e.guild_id,channelId:e.id,threads:a})}}),[e.id,e.guild_id,n,t])};t.useMessageCount=function(e){var t=(0,o.useStateFromStores)([f.default],(function(){var t;return null!==(t=f.default.getCount(e.id))&&void 0!==t?t:0})),n=t-1>=R.MAX_THREAD_MESSAGE_COUNT?R.MAX_THREAD_MESSAGE_COUNT+"+":Math.max(t-1,0),r=(0,o.useStateFromStores)([g.default],(function(){return g.default.hasTrackedUnread(e.id)})),a=(0,o.useStateFromStores)([g.default],(function(){return g.default.hasEverViewed(e.id)})),u=(0,o.useStateFromStores)([A.default],(function(){return A.default.getCount(e.id)}));return{renderedMessageCount:n,displayedUnreadCount:a&&r&&null!=u&&u>0?u>=10?"10+":u:null}};t.useMostUsedReaction=function(e){
var t,n,r,u=a.default.sortBy(null!==(t=null==e?void 0:e.reactions)&&void 0!==t?t:[],"count").reverse()[0],o=null!==(n=null==u?void 0:u.emoji)&&void 0!==n?n:k,l=null!==(r=null==u?void 0:u.count)&&void 0!==r?r:0;return{emoji:o,count:l,reaction:u}};t.useTypingUserIds=function(e){return(0,o.useStateFromStoresArray)([_.default,S.default,m.default],(function(){var t=S.default.getCurrentUser();return(0,a.default)(_.default.getTypingUsers(e.id)).keys().filter((function(e){return e!==(null==t?void 0:t.id)})).reject(m.default.isBlocked).map((function(e){return S.default.getUser(e)})).filter(E.isNotNullish).map((function(e){return e.id})).value()}))};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=O(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){
var o=a?Object.getOwnPropertyDescriptor(e,u):null;o&&(o.get||o.set)?Object.defineProperty(r,u,o):r[u]=e[u]}r.default=e;n&&n.set(e,r);return r}(n(667294)),a=P(n(496486)),u=P(n(795715)),o=n(536211),l=P(n(636602)),i=P(n(822350)),s=P(n(116518)),d=n(907932),c=P(n(782270)),f=P(n(979674)),p=n(566142),h=P(n(644263)),y=P(n(737483)),v=P(n(689389)),g=P(n(191391)),m=P(n(290629)),_=P(n(946447)),S=P(n(728429)),E=n(71246),T=P(n(408643)),b=n(140092),A=P(n(962935)),C=n(770348),I=n(173652),R=n(64072);function P(e){return e&&e.__esModule?e:{default:e}}function O(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(O=function(e){return e?n:t})(e)}function w(){w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return w.apply(this,arguments)}var M=(0,i.default)({id:"2021-07_threads_only_channel",label:"Threads only channel",kind:"guild",defaultConfig:{enabled:!1},
treatments:[{id:1,label:"On",config:{enabled:!0}}]});t.GuildForumExperiment=M;function N(e){return M.useExperiment({guildId:e}).enabled}function U(e){var t=null==e?void 0:e.parent_id,n=(0,o.useStateFromStores)([h.default],(function(){return h.default.getChannel(t)}),[t]);return r.useMemo((function(){var e;return null==n||null===(e=n.availableTags)||void 0===e?void 0:e.reduce((function(e,t){var n;return w({},e,((n={})[t.id]=t,n))}),{})}),[null==n?void 0:n.availableTags])}var k={id:null,name:"👍"}},140092:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.useFindFirstMediaProperties=function(e,t){var n,o=r.InlineAttachmentMedia.useSetting(),l=r.InlineEmbedMedia.useSetting(),i=r.RenderEmbeds.useSetting();if(null==e)return null;var s=o?null===(n=e.attachments)||void 0===n?void 0:n.find((function(e){return function(e){if(null==e)return!1;var t=e.filename,n=e.height,r=e.width;return a.IMAGE_RE.test(t)&&null!=n&&n>0&&null!=r&&r>0}(e)||function(e){
return null!=e&&(null!=e&&a.VIDEO_RE.test(e.filename)&&null!=e.proxy_url)}(e)})):null;if(null!=s){var d=s.proxy_url,c=s.url,f=s.description,p=s.spoiler,h=s.width,y=s.height,v=s.filename;return null==h||null==y?null:{src:a.VIDEO_RE.test(v)?d+"?format=jpeg":null!=d?d:c,width:h,height:y,spoiler:null!=p&&p,alt:f}}if(!l||!i)return null;if(null==e.embeds)return null;for(var g,m=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}
throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.embeds);!(g=m()).done;){var _,S=g.value,E=null!==(_=S.image)&&void 0!==_?_:S.thumbnail;null==E&&null!=S.images&&(E=S.images[0]);if(null!=E&&null!=E.url){var T=E,b=T.height,A=T.proxyURL,C=T.url,I=T.width;return{src:null!=A&&""!==A?A:C,height:b,width:I,spoiler:t}}}return null};var r=n(894826),a=n(100678);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},962935:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=void 0;var r,a=c(n(441143)),u=c(n(536211)),o=c(n(636602)),l=c(n(782270)),i=c(n(644263)),s=c(n(191391)),d=n(770348);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){f=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return f(e,t)}var p={},h=new Set;var y=function(e){!function(e,t){e.prototype=Object.create(t.prototype)
;e.prototype.constructor=e;f(e,t)}(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.initialize=function(){this.waitFor(l.default,i.default,s.default)};n.getCount=function(e){return p[e]};n.getThreadIdsMissingCounts=function(e,t){(0,a.default)(l.default.hasLoaded(e),"must wait for THREAD_LIST_SYNC before calling this");return t.filter((function(e){return!(e in p)&&!h.has(e)}))};return t}(u.default.Store);y.displayName="ForumPostUnreadCountStore";var v=new y(o.default,((r={})[d.ActionTypes.CONNECTION_OPEN]=function(){p={};h=new Set},r[d.ActionTypes.THREAD_CREATE]=function(e){var t=e.channel;if(!e.isNewlyCreated)return!1;if(!l.default.hasLoaded(t.guild_id))return!1;p[t.id]=0},r[d.ActionTypes.MESSAGE_CREATE]=function(e){var t=e.channelId,n=e.optimistic,r=e.isPushNotification;if(n||r)return!1;if(!(t in p))return!1;p[t]++},r[d.ActionTypes.FORUM_UNREADS]=function(e){e.threads.forEach((function(e){null!=e.count&&(p[e.threadId]=e.count)}))},
r[d.ActionTypes.MESSAGE_ACK]=function(e){var t=e.channelId;if(!(t in p)){var n=i.default.getChannel(t),r=i.default.getChannel(null==n?void 0:n.parent_id);if(!(null==r?void 0:r.isForumChannel()))return!1}p[t]=s.default.getUnreadCount(t)},r[d.ActionTypes.REQUEST_FORUM_UNREADS]=function(e){e.threads.forEach((function(e){var t=e.threadId;return h.add(t)}))},r));t.default=v},946447:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=void 0;var r,a=d(n(536211)),u=d(n(118915)),o=d(n(636602)),l=d(n(423046)),i=n(249875),s=n(770348);function d(e){return e&&e.__esModule?e:{default:e}}function c(e,t){c=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return c(e,t)}function f(){f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return f.apply(this,arguments)}var p,h={},y=Object.freeze({});function v(e){var t;return null!==(t=h[e])&&void 0!==t?t:y}
function g(e){var t=e.channelId,n=e.userId,r=f({},v(t));clearTimeout(r[n]);r[n]=function(e,t){return setTimeout((function(){o.default.dispatch({type:s.ActionTypes.TYPING_STOP,channelId:e,userId:t})}),s.TYPING_TIMEOUT)}(t,n);h[t]=r}function m(e){var t=e.channelId,n=e.userId,r=h[t];if(null==r||null==r[n])return!1;var a=f({},r);clearTimeout(a[n]);delete a[n];h[t]=a}function _(){h={}}var S=function(e){!function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;c(e,t)}(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.getTypingUsers=function(e){return v(e)};n.isTyping=function(e,t){return null!=v(e)[t]};return t}(a.default.Store);S.displayName="TypingStore";var E=new S(o.default,((r={})[s.ActionTypes.TYPING_START]=g,r[s.ActionTypes.TYPING_STOP]=m,r[s.ActionTypes.TYPING_START_LOCAL]=function(e){var t=e.channelId,n=l.default.getId();if(null==n)return!1;if(null!=p&&p.channelId!==t){null!=p.timeout&&clearTimeout(p.timeout);p=null}
var r=Date.now(),a=.8*s.TYPING_TIMEOUT;if(null!=p&&(null!=p.timeout||p.prevSend+a>r))return!1;var d=null==p||p.prevSend>r-2*a?s.TYPING_DELAY_LOCAL:0,c=setTimeout((function(){if(null!=p&&p.channelId===t&&n===l.default.getId()&&null!=p.timeout){p.timeout=null;(function(e){var t=v(e);return t===y?0:Object.keys(t).length})(t)>s.MAX_TYPING_USERS||u.default.post({url:s.Endpoints.TYPING(t),oldFormErrors:!0}).then((function(e){if(200===e.status){var n,r,a=null!==(n=e.body.message_send_cooldown_ms)&&void 0!==n?n:0,u=null!==(r=e.body.thread_create_cooldown_ms)&&void 0!==r?r:0;a>0&&o.default.dispatch({type:s.ActionTypes.SLOWMODE_SET_COOLDOWN,channelId:t,slowmodeType:i.SlowmodeType.SendMessage,cooldownMs:a});u>0&&o.default.dispatch({type:s.ActionTypes.SLOWMODE_SET_COOLDOWN,channelId:t,slowmodeType:i.SlowmodeType.CreateThread,cooldownMs:u})}}))}}),d);p={channelId:t,timeout:c,prevSend:r};return g({channelId:t,userId:n})},r[s.ActionTypes.TYPING_STOP_LOCAL]=function(e){
var t=e.channelId,n=l.default.getId();if(null==n)return!1;if(null!=p&&p.channelId===t&&null!=p.timeout){clearTimeout(p.timeout);p=null;return m({channelId:t,userId:n})}return!1},r[s.ActionTypes.CONNECTION_OPEN]=_,r[s.ActionTypes.OVERLAY_INITIALIZE]=_,r[s.ActionTypes.MESSAGE_CREATE]=function(e){var t=e.channelId,n=e.message.author;e.optimistic&&function(e){if(null==p||p.channelId!==e)return!1;null!=p.timeout&&clearTimeout(p.timeout);p=null}(t);return m({channelId:t,userId:n.id})},r));t.default=E}}]);
//# sourceMappingURL=ad3bc2c9873cb6695482.js.map